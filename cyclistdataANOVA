# Load required libraries
library(dplyr)
library(ggplot2)
library(emmeans)

# Read the cyclist data from the specified file path
cyclist_data <- read.csv("C:/Users/Aoudarya Sanaka/Videos/R files/cyclist_counts_t.csv", header = FALSE, sep = ";", stringsAsFactors = FALSE)

# Convert non-numeric variables to numeric
cyclist_data$V3 <- as.numeric(cyclist_data$V3)
cyclist_data$V4 <- as.numeric(cyclist_data$V4)
cyclist_data$V5 <- as.numeric(cyclist_data$V5)
cyclist_data$V6 <- as.numeric(cyclist_data$V6)

# Create a matrix from the data
data_matrix <- as.matrix(cyclist_data[, c(3:6)])

# Perform ANOVA on the data
anova_result1 <- aov(data_matrix ~ V3 * V4, data = cyclist_data)


# Print the ANOVA table for the data
print(summary(anova_result))

# Extract the mean differences for each counting station
emmeans_result1 <- emmeans(anova_result, specs = ~ V3 * V4, type = "response")


# Print the mean differences and confidence intervals
print(emmeans_result1)


# Create box plots for each response variable
boxplot(data_matrix ~ V3 * V4, data = cyclist_data, main = "Data", xlab = "Counting Stations", ylab = "Response")
